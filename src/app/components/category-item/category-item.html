<li
  class="tree-item"
  [class.has-children]="hasChildren"
  [class.expanded]="item.expanded"
  [class.level-0]="level === 0"
  [class.level-1]="level === 1"
  [class.level-2]="level >= 2"
  [style.--indent.px]="0"
>
  <div
    class="item-row d-flex align-items-center w-100 gap-0"
    (click)="onRowClick($event)"    
  >
    @if (hasChildren) {
      <!-- Botón caret -->
      <button
        type="button"
        class="btn btn-sm btn-light-subtle rounded-3 btn-caret d-inline-grid place-center"
        [attr.aria-expanded]="item.expanded"
        (click)="toggle($event)"
      >
        <i class="bi" [ngClass]="item.expanded ? 'bi-chevron-down' : 'bi-chevron-right'"></i>
      </button>
    }
    <!-- Nombre del ítem -->
    <span class="label flex-grow-1 text-truncate">
      <span [innerHTML]="item.icon == 'folder' ? '📁' : this.getIconForExtension(this.getFileExtension(item.name))"></span>
      {{ item.name | removeExtension }}
    </span>

    @if (item.count > 0) {
      <span class="badge text-bg-light border ms-2">{{ item.count }}</span>
    }
  </div>

  @if (hasChildren && item.expanded) {
    <ul class="list-unstyled children border-start ms-3 ps-3">
      @for (category of item.children; track category) {
        <app-category-item
          [item]="category"
          [level]="level + 1"
          (select)="select.emit($event)"
        ></app-category-item>
      }
    </ul>
  }
</li>
